{"version":3,"file":"_page.svelte-q3Yam5v2.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/_site_/_page.svelte.js"],"sourcesContent":["import { c as create_ssr_component, j as subscribe, q as set_store_value, v as validate_component } from \"../../../chunks/index3.js\";\nimport { B as locked_blocks } from \"../../../chunks/Page.svelte_svelte_type_style_lang.js\";\nimport \"../../../chunks/Icon.js\";\nimport \"mousetrap\";\nimport \"axios\";\nimport \"file-saver\";\nimport \"autosize\";\nimport { P as Page$1 } from \"../../../chunks/Page.js\";\nimport { customAlphabet } from \"nanoid/non-secure\";\nfunction createUniqueID(length = 5) {\n  const nanoid = customAlphabet(\"abcdefghijklmnopqrstuvwxyz\", length);\n  return nanoid();\n}\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let $locked_blocks, $$unsubscribe_locked_blocks;\n  $$unsubscribe_locked_blocks = subscribe(locked_blocks, (value) => $locked_blocks = value);\n  let { data } = $$props;\n  const { supabase } = data;\n  const presence_key = createUniqueID();\n  const channel = supabase.channel(`locked-blocks`, {\n    config: { presence: { key: presence_key } }\n  });\n  channel.subscribe(async (status) => {\n    if (status === \"SUBSCRIBED\") {\n      channel.track({ active_block: null });\n    }\n  });\n  channel.on(\"presence\", { event: \"sync\" }, () => {\n    const state = channel.presenceState();\n    set_store_value(\n      locked_blocks,\n      $locked_blocks = Object.entries(state).map(([key, value]) => ({\n        key,\n        block_id: value[0][\"active_block\"],\n        user: value[0][\"user\"]\n      })).filter((block) => block.key !== presence_key),\n      $locked_blocks\n    );\n  });\n  if ($$props.data === void 0 && $$bindings.data && data !== void 0)\n    $$bindings.data(data);\n  $$unsubscribe_locked_blocks();\n  return `${validate_component(Page$1, \"PrimoPage\").$$render(\n    $$result,\n    {\n      page: { ...data.page, sections: data.sections }\n    },\n    {},\n    {}\n  )}`;\n});\nexport {\n  Page as default\n};\n//# sourceMappingURL=_page.svelte.js.map\n"],"names":[],"mappings":";;;;;;;;;;;;AASA,SAAS,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;AACpC,EAAE,MAAM,MAAM,GAAG,cAAc,CAAC,4BAA4B,EAAE,MAAM,CAAC;AACrE,EAAE,OAAO,MAAM,EAAE;AACjB;AACK,MAAC,IAAI,GAAG,oBAAoB,CAAC,CAAC,QAAQ,EAAE,OAAO,EAAE,UAAU,EAAE,KAAK,KAAK;AAC5E,EAAE,IAAI,cAAc,EAAE,2BAA2B;AACjD,EAAE,2BAA2B,GAAG,SAAS,CAAC,aAAa,EAAE,CAAC,KAAK,KAAK,cAAc,GAAG,KAAK,CAAC;AAC3F,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,OAAO;AACxB,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI;AAC3B,EAAE,MAAM,YAAY,GAAG,cAAc,EAAE;AACvC,EAAE,MAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC,aAAa,CAAC,EAAE;AACpD,IAAI,MAAM,EAAE,EAAE,QAAQ,EAAE,EAAE,GAAG,EAAE,YAAY,EAAE;AAC7C,GAAG,CAAC;AACJ,EAAE,OAAO,CAAC,SAAS,CAAC,OAAO,MAAM,KAAK;AACtC,IAAI,IAAI,MAAM,KAAK,YAAY,EAAE;AACjC,MAAM,OAAO,CAAC,KAAK,CAAC,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;AAC3C;AACA,GAAG,CAAC;AACJ,EAAE,OAAO,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,MAAM;AAClD,IAAI,MAAM,KAAK,GAAG,OAAO,CAAC,aAAa,EAAE;AACzC,IAAI,eAAe;AACnB,MAAM,aAAa;AACnB,MAAM,cAAc,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,MAAM;AACpE,QAAQ,GAAG;AACX,QAAQ,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC;AAC1C,QAAQ,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM;AAC7B,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC,GAAG,KAAK,YAAY,CAAC;AACvD,MAAM;AACN,KAAK;AACL,GAAG,CAAC;AACJ,EAAE,IAAI,OAAO,CAAC,IAAI,KAAK,SAAM,IAAI,UAAU,CAAC,IAAI,IAAI,IAAI,KAAK,SAAM;AACnE,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC;AACzB,EAAE,2BAA2B,EAAE;AAC/B,EAAE,OAAO,CAAC,EAAE,kBAAkB,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC,QAAQ;AAC5D,IAAI,QAAQ;AACZ,IAAI;AACJ,MAAM,IAAI,EAAE,EAAE,GAAG,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ;AACnD,KAAK;AACL,IAAI,EAAE;AACN,IAAI;AACJ,GAAG,CAAC,CAAC;AACL,CAAC;;;;"}